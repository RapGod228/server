CHECK_INCLUDE_FILES(lzo/lzo1x.h HAVE_LZO_H)
CHECK_LIBRARY_EXISTS(lzo2 lzo1x_1_compress "" HAVE_LZO_COMPRESS)

IF (HAVE_LZO_H AND HAVE_LZO_COMPRESS)
  MYSQL_ADD_PLUGIN(lzo_plugin plugin.c MODULE_OUTPUT_NAME lzo
    COMPONENT lzo LINK_LIBRARIES lzo2)

  GET_PROPERTY(dirs TARGET lzo_plugin PROPERTY INCLUDE_DIRECTORIES)
  LIST(REMOVE_ITEM dirs ${CMAKE_SOURCE_DIR}/include/wrappers)
  SET_PROPERTY(TARGET lzo_plugin PROPERTY INCLUDE_DIRECTORIES "${dirs}")
ENDIF()
