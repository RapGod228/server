#
# Testing lzma compression with innodb
#
set global innodb_compression_algorithm = lzma;
call mtr.add_suppression("InnoDB: Background Page read failed to read or decrypt \\[page id: space=\\d+, page number=\\d+\\]");
call mtr.add_suppression("InnoDB: Table `test`.`t1` is corrupted. Please drop the table and recreate.");
CREATE TABLE t1 (a int, b text ) engine = innodb page_compressed = 1;
insert t1 (a, b) values (0, repeat("abc", 100));
insert t1 (a, b) values (1, repeat("def", 1000));
insert t1 (a, b) values (2, repeat("ghi", 10000));
select a, left(b, 9), length(b) from t1;
a	left(b, 9)	length(b)
0	abcabcabc	300
1	defdefdef	3000
2	ghighighi	30000
# restart: --disable-lzma
select a, left(b, 9), length(b) from t1;
ERROR 42S02: Table 'test.t1' doesn't exist in engine
drop table t1;
# restart
